<div>
  <mat-toolbar>
    <mat-toolbar-row>
      <a  mat-button  [matMenuTriggerFor]="users" routerLink="/candidates-list" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">Manage Users</a>
      <mat-menu #users="matMenu">
        <a mat-menu-item routerLink="/create-candidate" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">Add Candidate</a>
        <a mat-menu-item routerLink="/adminuser-create" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">Add User</a>
        <a mat-menu-item routerLink="/candidates-list" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">View Candidate</a>
      </mat-menu>
      <a  mat-button  [matMenuTriggerFor]="questions" routerLink="/manage-questionbank" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">Manage Questions</a>
      <mat-menu #questions="matMenu">
        <a mat-menu-item  routerLink="/manage-questionbank" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">Add Question</a>
        <a mat-menu-item  routerLink="/manage-questionbank-bulk" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">Add Bulk Question</a>
        <a mat-menu-item  routerLink="/view-questionbank" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active"> View Question</a>
      </mat-menu>
      <a  mat-button  [matMenuTriggerFor]="metadata" routerLink="/jrss-create" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">Manage Metadata</a>
      <mat-menu #metadata="matMenu">
        <a mat-menu-item  routerLink="/jrss-create" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">Add Job Role</a>
        <a mat-menu-item  routerLink="/stream-create" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">Add Technology Stream</a>
        <a mat-menu-item  routerLink="/testconfig-add" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">Add Test Configuration</a>
      </mat-menu>
      <a  mat-button  routerLink="/workflow-config" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">Manage WorkFlows</a>
      <a  mat-button  [matMenuTriggerFor]="openpositions" routerLink="/openpositions-list" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">Manage OpenSeats</a>
      <mat-menu #openpositions="matMenu">
        <a mat-menu-item routerLink="/openpositions-create" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">Add Open Seat</a>
        <a mat-menu-item routerLink="/openpositions-list" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">View Open Seats</a>
      </mat-menu>
      <a  mat-button  routerLink="/view-testresults" [state]="{username:this.userName, accessLevel:'admin',account:this.account}" routerLinkActive="active">Test Results</a>
      <a  mat-button  routerLink="/login-component" routerLinkActive="active">Logout</a>
     </mat-toolbar-row>
  </mat-toolbar>
  </div>
  <br/>
  <div class="float-left text-left">
    <h4 class="my-0 mr-md-auto font-weight-normal">Add Bulk Questions</h4></div>
  <br/><br>

<!-- form Test Config -->
<mat-card class="login-card">
  <mat-card-header></mat-card-header>
  <mat-card-content>
    <form [formGroup]="questionForm">
      <table class="open-full-width" cellspacing="0">

        <!-- Technology Stream -->
        <tr>
          <td>
            <mat-form-field class="question-full-width">
              <mat-select placeholder="Technology Stream"  (selectionChange)="updateTechnologyStream($event.value)"
                  formControlName="technologyStream" required id="inputTechnologyStream" [ngClass]="{ 'is-invalid': !formReset && submitted && myForm.technologyStream.errors }" >
                  <mat-option value="">Choose...</mat-option>
                  <mat-option *ngFor="let data of technologyStream" value="{{data.technologyStream}}">{{data.technologyStream}}</mat-option>
              </mat-select>
              <div *ngIf="!formReset && submitted && myForm.technologyStream.errors" class="invalid-feedback" >
                <div *ngIf="myForm.technologyStream.errors.required">Technology Stream is required</div>
              </div>
            </mat-form-field>
          </td>   
        </tr>
        
        <!-- Bulk Upload template -->
        <div class="float-left text-left">
            <p style="color:blue;" (click)="bulkUploadTemplate()"><span style="cursor:pointer"><u>Bulk Upload Template</u></span></p>
        </div>
        <br>

        <!-- Upload Bulk Questions File -->
        <tr>
          <td>
            <div class="float-left text-right">
              <label for="inputTechnologyStream" >Upload Bulk Questions File</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <input type="file" id="fileName" (change)="addfile($event)" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" size="50">
            </div>
          </td>   
        </tr>
        <br/>
        <div>
            <p><b>{{ bulkUploadQuestions }} out of {{ totalBulkQuestions }} questions uploaded</b></p>
        </div>

      </table>
    </form>
  </mat-card-content>

    <mat-card-actions>
      <div class="row justify-content-center">
        <button mat-raised-button color="primary" (click)="bulkUploadFile()">Upload File</button>
        <button mat-raised-button color="primary" (click)="resetForm()">Reset</button>
        <button mat-raised-button color="primary" (click)="cancelForm()">Cancel</button>
      </div>
    </mat-card-actions>
</mat-card>
